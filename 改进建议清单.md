# AI漫画生成器项目改进建议清单

基于对项目的详细检查，以下是针对三个核心问题的具体改进方案：

## 🔧 1. FFmpeg打包问题修复

**问题**：`src/utils/audio_extractor.py` 直接调用系统ffmpeg，可能导致打包应用失败

**解决方案**：
```python
# 修改 src/utils/audio_extractor.py
from src.utils.system_check import get_ffmpeg_path

# 将原来的 ffmpeg 命令调用改为
ffmpeg_path = get_ffmpeg_path()
cmd = [ffmpeg_path, "-i", input_file, ...]
```

**优先级**：🔴 高（应用打包后可能导致音频功能失败）

## 📋 2. 日志系统统一和改进

### A. 统一日志路径
**决策建议**：采用 `~/.lumen-x/` 作为统一路径（与README文档一致）

**需要修改的文件**：
1. `main.py` - 修改日志路径为 `~/.lumen-x/app.log`
2. WebView存储路径：`~/.lumen-x/webview_storage`
3. 项目数据路径：`~/.lumen-x/projects/`

### B. 添加应用内日志查看器
**新建文件**：`frontend/src/components/modules/LogViewer.tsx`

**功能**：
- 按时间倒序显示日志（最近优先）
- 支持日志等级筛选（ERROR/WARNING/INFO/DEBUG）
- 支持关键词搜索
- 一键打开日志目录
- 清除日志功能

### C. 日志功能集成点
1. 设置页面添加"查看日志"按钮
2. 错误提示中增加"查看日志"链接
3. 主菜单添加"帮助 > 查看日志"选项

**优先级**：🟡 中（提升用户体验，便于问题排查）

## 📚 3. 文档更新

### A. README.md 修正
1. **统一日志路径**：将所有日志路径更新为 `~/.lumen-x/`
2. **日志查看说明**：添加详细步骤
3. **新增FAQ部分**：
   - "如何查看应用日志？"
   - "为什么我需要配置API Key？"
   - "OSS配置失败怎么办？"

### B. 新建用户手册
创建 `USAGE.md` 文件，包含：
1. 应用安装步骤（区分平台）
2. 首次使用配置指南
3. 常见问题排查（附带日志查看方法）
4. 各功能模块详细说明

### C. 快速开始视频/图文教程
考虑创建简单的使用教程，特别是：
- 如何配置API Key
- 如何设置OSS
- 如何查看日志排查问题

## 🔧 4. 其他建议

### A. 启动时预检查
在应用启动时添加检查项：
1. FFmpeg可用性检查
2. API Key配置检查
3. 必要的目录创建

### B. 错误处理改进
1. 所有错误提示都附带"查看日志"链接
2. 关键操作失败时记录详细错误信息
3. 发送错误报告功能

### C. 日志轮转
实现简单的日志轮转机制：
- 主日志文件大小限制（如10MB）
- 保留最近5个备份文件
- 自动清理旧日志

## 📅 实施优先级

1. **立即修复**（发布前必须完成）：
   - FFmpeg路径修复（audio_extractor.py）
   - 统一日志路径

2. **用户体验改进**（建议发布后尽快添加）：
   - 应用内日志查看器
   - 错误提示中增加日志链接

3. **文档完善**（持续进行）：
   - README.md更新
   - 用户手册创建
   - 教程制作

## 💡 实施建议

1. **先修复关键bug**：确保应用打包后功能完整
2. **统一基础架构**：日志路径和应用数据管理
3. **增加调试友好性**：帮助用户自主解决问题
4. **完善文档**：减少用户困惑和支持负担

这些改进将显著提升应用的稳定性和用户体验，特别是对于非技术用户来说，能够更容易地解决问题。